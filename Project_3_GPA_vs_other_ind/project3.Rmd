---
title: "Food choices"
---

```{r setup, include=FALSE}
library(tidyverse)
library(colorspace)
library(ggforce)
knitr::opts_chunk$set(echo = TRUE)
```

This is the dataset we will be working with:

```{r message = FALSE, warning = FALSE}
food <- readr::read_csv(
  "https://wilkelab.org/DSC385/datasets/food_coded.csv",
  na = c("Unknown", "nan", "Personal"))
food
```

A detailed data dictionary for this dataset is available [here.](https://wilkelab.org/DSC385/datasets/food_codebook.pdf) The dataset was originally downloaded from Kaggle, and you can find additional information about the dataset [here.](https://www.kaggle.com/borapajo/food-choices/version/5)


## **Question:** 
Is GPA related to student income, the father's educational level, or the student's perception of what an ideal diet is?


## **Introduction:**

Introduction: We are working with a subset of the food choices and preferences of college students' dataset, which contains responses from 126  students of *Mercyhurst University* who agreed to participate in a survey. While the original dataset has 61 variables, this analysis focuses on four variables: (1) GPA, (2) student income, (3) the father's educational level, and (4) the student's perception of what an ideal diet is. 

`GPA` is provided as a numeric value on a scale from 1.0 to 4.0 (unitless).

`income` is encoded as a numeric variable with values of 1 to 6 as follows:

* 1 -> less than $15,000
* 2 -> $15,001 to $30,000
* 3 -> $30,001 to $50,000
* 4 -> $50,001 to $70,000
* 5 -> $70,001 to $100,000
* 6 -> higher than $100,000

`father_education` is encoded as a numeric variable with values of 1 to 5 as follows:

* 1 -> less than high school 
* 2 -> high school degree
* 3 -> some college degree
* 4 -> college degree
* 5 -> graduate degree

The student's perception of what an ideal diet is `ideal_diet_coded`  is encoded as a numeric variable with values of 1 to 8 as follows:

* 1 -> portion control
* 2 -> adding veggies/eating healthier food/adding fruit 3 â€“ balance
* 4 -> less sugar
* 5 -> home cooked/organic
* 6 -> current diet
* 7 -> more protein
* 8 -> unclear

## **Approach:** 


## **Analysis:**


### 1.0 Data Inspection
```{r }
# Get only the four columns of interest
food <- food[c("GPA","income","father_education", "ideal_diet_coded")]
colnames(food)
```
#### 1.1 `GPA`

Missing values encoded as `"Unknown"`, `"nan"`, or `"Personal"` where parsed as valid `NAs` at reading time. However, one more entry has an invalid string, which is handled below.

```{r }
food$GPA <- sub(' bitch','',food$GPA)
```

Convert to numeric
```{r }
food$GPA <- as.numeric(food$GPA)
```

Summary Stats
```{r }
summary(food$GPA)
```
#### 1.2 `income`

Categories are re-coded following the data dictionary.

```{r }
# Unique values
sort(unique(food$income), na.last = TRUE)
```
```{r }
food <- food %>%
  mutate(
    income = case_when(
      income == 1 ~ "< 15k",
      income == 2 ~ "(15k - 30k]",
      income == 3 ~ "(30k - 50k]",
      income == 4 ~ "(50k - 70k]",
      income == 5 ~ "(70k - 100k]",
      income == 6 ~ "> 100k"
    )
  )
food$income<- fct_relevel(as.factor(food$income),
                             "< 15k", "(15k - 30k]", "(30k - 50k]",
                             "(50k - 70k]", "(70k - 100k]","> 100k")
unique(food$income)
table(food$income, useNA = "ifany")

```   
#### 1.3 `father_education`

Categories are re-coded following the data dictionary.

```{r }
# Unique values
sort(unique(food$father_education), na.last = TRUE)
```
```{r }
food <- food %>%
  mutate(
    father_education = case_when(
      father_education == 1 ~ "< High School",
      father_education == 2 ~ "High School",
      father_education == 3 ~ "Some College",
      father_education == 4 ~ "College",
      father_education == 5 ~ "Graduate",
    )
  )
food$father_education<- fct_relevel(as.factor(food$father_education),
                             "< High School", "High School","Some College",
                             "College", "Graduate")
unique(food$father_education)
table(food$father_education, useNA = "ifany")
```   
#### 1.4 `ideal_diet_coded`

Categories are re-coded following the data dictionary.

```{r }
# Unique values
sort(unique(food$ideal_diet_coded), na.last = TRUE)
```

```{r }
food <- food %>%
  mutate(
    ideal_diet_coded = case_when(
      ideal_diet_coded == 1 ~ "Portion control",
      ideal_diet_coded == 2 ~ "Healthy w/ veg & fruit",
      ideal_diet_coded == 3 ~ "Balanced",
      ideal_diet_coded == 4 ~ "Less sugar",
      ideal_diet_coded == 5 ~ "Home cooked/organic",
      ideal_diet_coded == 6 ~ "Current Diet",
      ideal_diet_coded == 7 ~ "More protein",
      ideal_diet_coded == 8 ~ "Unclear",
    )
  )
unique(food$ideal_diet_coded)
table(food$ideal_diet_coded, useNA = "ifany")
```   
### 2.0 Data Visualization

#### 2.1 GPA vs Income
```{r}

food %>%
  filter(!is.na(income)) %>%
  
  ggplot(aes(x = income, y = GPA)) + 
  geom_violin(scale = "width", fill = 'skyblue') +  
  geom_dotplot(binaxis='y', stackdir='center', dotsize=0.5) + 
  stat_summary(
              fun.data = "mean_cl_boot",
              geom = "crossbar",
              colour = "red", width = 0.3
              ) +
  scale_y_continuous('GPA',  breaks= seq(from = 1, to = 4, by = 0.5), limits = c(2,4)) +
  labs(title = 'Students GPA versus Students income') + 
  xlab('Income ($USD)') +
  theme_bw()
```
