---
title: "Food choices"
---

```{r setup, include=FALSE}
library(tidyverse)
library(colorspace)
knitr::opts_chunk$set(echo = TRUE)
```

This is the dataset we will be working with:

```{r message = FALSE, warning = FALSE}
food <- readr::read_csv(
  "https://wilkelab.org/DSC385/datasets/food_coded.csv",
  na = c("Unknown", "nan", "Personal"))
food
```

A detailed data dictionary for this dataset is available [here.](https://wilkelab.org/DSC385/datasets/food_codebook.pdf) The dataset was originally downloaded from Kaggle, and you can find additional information about the dataset [here.](https://www.kaggle.com/borapajo/food-choices/version/5)


## **Question:** 
Is GPA related to student income, the father's educational level, or the student's perception of what an ideal diet is?


## **Introduction:**


## **Approach:** 


## **Analysis:**


### 1.0 Data Inspection
```{r }
# Get only the four columns of interest
food <- food[c("GPA","income","father_education", "ideal_diet_coded")]
colnames(food)
```
#### 1.1 `GPA`

Missing values encoded as `"Unknown"`, `"nan"`, or `"Personal"` where parsed as valid `NAs` at reading time. However, one more entry has an invalid string, which is handled below.

```{r }
food$GPA <- sub(' bitch','',food$GPA)
```

Convert to numeric
```{r }
food$GPA <- as.numeric(food$GPA)
```

Summary Stats
```{r }
summary(food$GPA)
```
#### 1.2 `income`

Categories are re-coded following the data dictionary.

```{r }
# Unique values
sort(unique(food$income), na.last = TRUE)
```
```{r }
food <- food %>%
  mutate(
    income = case_when(
      income == 1 ~ "< 15,000",
      income == 2 ~ "15,001 - 30,000",
      income == 3 ~ "30,001 - 50,000",
      income == 4 ~ "50,001 - 70,000",
      income == 5 ~ "70,001 - 100,000",
      income == 6 ~ "> 100,000"
    )
  )
food$income<- fct_relevel(as.factor(food$income),
                             "< 15,000", "15,001 - 30,000", "30,001 - 50,000",
                             "50,001 - 70,000", "70,001 - 100,000","> 100,000")
unique(food$income)
table(food$income, useNA = "ifany")

```   
#### 1.3 `father_education`

Categories are re-coded following the data dictionary.

```{r }
# Unique values
sort(unique(food$father_education), na.last = TRUE)
```
```{r }
food <- food %>%
  mutate(
    father_education = case_when(
      father_education == 1 ~ "< High School",
      father_education == 2 ~ "High School",
      father_education == 3 ~ "Some College",
      father_education == 4 ~ "College",
      father_education == 5 ~ "Graduate",
    )
  )
food$father_education<- fct_relevel(as.factor(food$father_education),
                             "< High School", "High School","Some College",
                             "College", "Graduate")
unique(food$father_education)
table(food$father_education, useNA = "ifany")
```   
#### 1.4 `ideal_diet_coded`

Categories are re-coded following the data dictionary.

```{r }
# Unique values
sort(unique(food$ideal_diet_coded), na.last = TRUE)
```

```{r }
food <- food %>%
  mutate(
    ideal_diet_coded = case_when(
      ideal_diet_coded == 1 ~ "Portion control",
      ideal_diet_coded == 2 ~ "Healthy w/ veg & fruit",
      ideal_diet_coded == 3 ~ "Balanced",
      ideal_diet_coded == 4 ~ "Less sugar",
      ideal_diet_coded == 5 ~ "Home cooked/organic",
      ideal_diet_coded == 6 ~ "Current Diet",
      ideal_diet_coded == 7 ~ "More protein",
      ideal_diet_coded == 8 ~ "Unclear",
    )
  )
unique(food$ideal_diet_coded)
table(food$ideal_diet_coded, useNA = "ifany")
```   


## **Discussion:**


